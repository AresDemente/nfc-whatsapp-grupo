<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Invitaci√≥n WhatsApp ‚Äî Grupo + Mensaje</title>
  <style>
    body { font-family: system-ui, -apple-system, Roboto, "Segoe UI", Arial; padding: 18px; line-height:1.4; }
    .card { border-radius:12px; padding:18px; box-shadow:0 6px 18px rgba(0,0,0,0.06); max-width:800px; margin:18px auto; }
    button { padding:10px 14px; border-radius:8px; border: none; font-size:16px; cursor:pointer; margin:8px 6px 0 0; }
    .primary { background:#25D366; color:#fff; }
    .ghost { background:#f1f1f1; color:#333; }
    .note { font-size:0.92rem; color:#444; margin-top:12px; }
    pre { background:#f7f7f7; padding:12px; border-radius:8px; overflow:auto; }
    .ok { color: #156515; font-weight:600; }
    .warn { color: #a54b00; font-weight:600; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Invitaci√≥n al grupo de WhatsApp</h2>
    <p class="note">Esta p√°gina abrir√° el grupo y copiar√° el mensaje al portapapeles para que s√≥lo pegues y env√≠es dentro del chat.</p>

    <script>
      const GROUP_LINK = "https://chat.whatsapp.com/FdFYefqCuRz8wKaAQkfXHb?mode=wwt";

      const MESSAGE = "Hola a todos, este es el mensaje predefinido desde mi tag NFC. üëã";
    </script>
    <!-- ======================================= -->

    <div id="status" class="note">Preparando...</div>

    <div style="margin-top:12px;">
      <button id="openGroupBtn" class="primary">Abrir grupo (WhatsApp)</button>
      <button id="openWaMsgBtn" class="ghost">Abrir WhatsApp con el mensaje</button>
      <button id="copyBtn" class="ghost">Copiar mensaje nuevamente</button>
    </div>

    <p class="note">Si ya eres miembro del grupo: al abrir el grupo, pega (<span class="ok">Ctrl+V</span> o mant√©n pulsado y pegar) dentro del cuadro de texto y env√≠a.</p>

    <div style="margin-top:14px;">
      <strong>Mensaje que se copiar√°:</strong>
      <pre id="msgPreview"></pre>
    </div>

    <p class="note warn">Importante: por restricciones de WhatsApp no es posible insertar el texto directamente dentro del chat del grupo con una sola URL. Esta p√°gina automatiza la copia del texto y facilita abrir el grupo para pegarlo manualmente.</p>
  </div>

  <script>
    // UI references
    const status = document.getElementById('status');
    const msgPreview = document.getElementById('msgPreview');
    const openGroupBtn = document.getElementById('openGroupBtn');
    const openWaMsgBtn = document.getElementById('openWaMsgBtn');
    const copyBtn = document.getElementById('copyBtn');

    // Rellenar vista
    msgPreview.textContent = MESSAGE;

    // Copiar al portapapeles (promesa)
    async function copyMessage() {
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(MESSAGE);
          status.textContent = "Mensaje copiado al portapapeles ‚úÖ";
        } else {
          const ta = document.createElement('textarea');
          ta.value = MESSAGE;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          document.body.removeChild(ta);
          status.textContent = "Mensaje copiado (m√©todo alternativo) ‚úÖ";
        }
      } catch (err) {
        status.textContent = "No se pudo copiar autom√°ticamente. Selecciona el texto y c√≥pialo manualmente.";
      }
    }

    function openGroup() {
      window.location.href = GROUP_LINK;
    }

    function openWhatsAppWithText() {
      const encoded = encodeURIComponent(MESSAGE);
      const wa = "https://wa.me/?text=" + encoded;
      window.location.href = wa;
    }

    openGroupBtn.addEventListener('click', () => {
      copyMessage();
      setTimeout(() => openGroup(), 300);
    });

    openWaMsgBtn.addEventListener('click', () => {
      copyMessage();
      setTimeout(() => openWhatsAppWithText(), 300);
    });

    copyBtn.addEventListener('click', () => {
      copyMessage();
    });

    (async () => {
      await copyMessage();
      status.textContent = "Listo. Pulsa 'Abrir grupo' para entrar y pega el mensaje.";
    })();
  </script>
</body>
</html>
